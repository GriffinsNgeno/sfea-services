# livenessprobe_logic package

## Module contents

### *class* livenessprobe_logic.HealthCheck

Базовые классы: `object`

Класс проверки состояния LivenessProbe k8s

Экземпляр класса создается в исполняемом файле /bin/healthtest, который периодически
вызывается k8s для проверки работоспособности запущенного приложения. В случае exit
code = 0 - все ок, иначе перезапуск приложения. Проверка осуществляется за счет оценки
времени записи последнего ответа (timestamp) в определенный файл. Если timestamp был
записан более N секунд (например, 10 мин) назад, то exit code = 1. Обработчики
периодически вызывают метод `checkpoint` с целью обновления timestamp, тем самым
обновляя время жизни. Зависшие обработчики этого не делают, и поэтому проверку по
timestamp не пройдут

#### check(min_period)

Проверка записанного timestamp.

Если разница между текущим временем и timestamp больше min_period в секундах,
то exit code = 0

* **Параметры:**
  **min_period** (`float`) – максимальное время, когда обработчик может не вызывать

`checkpoint` метод, в секундах.
:rtype: `None`
:return: exit code 0 или 1

#### checkpoint(timestamp=None)

Основная общедоступная функция для обработчика.

Должна быть вызвана обработчиком для того, чтобы показать, что он „живой“.
Основной сценарий использования - вызвать после успешной обработки задачи
:type timestamp: 
:param timestamp: опциональное время timestamp на запись в файл
